<!DOCTYPE html>
<meta charset="utf-8">
<link rel="stylesheet" type="text/css" href="resources/css/style.css">
<link
	href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css"
	rel="stylesheet">


<script type="text/javascript">
	function callService() {

		var url = "/StandardDeviation";

		function handler() {

			if (client.status == 200) {
				alert("The request succeeded!\n\nThe response representation was:\n\n"
						+ client.responseText);
				print(client.responseText);
			} else
				alert(" ERROR : " + client.status + " " + client.statusText
						+ ".");
		}

		var client = new XMLHttpRequest();
		client.onreadystatechange = handler;
		client.open("GET", url);
		client.send();

	}

	function print(dataJSON) {
		
			var table = document.getElementById('tableServices');
			var rowCount = table.rows.length;
			
			/* 		{
			 "service": "NAME_SERVICE",
			 "variance": 34343,
			 "covariance": 343,
			 "ok": 44,
			 "fail_up": 16,
			 "fail_down":40
			 } */
			 
			 $.each(json, function(idx, data) {
					alert(obj.tagName);
					var row = table.getElementById("row"+data.service);
					if(row == null)
						row= addRow(table , dataJSON);
					
					var index = 0;
					row.cell[index++].innerHTM = dataJSON.service;
					row.cell[index++].innerHTM = dataJSON.variance;
					row.cell[index++].innerHTM = dataJSON.standaDesviation;
					row.cell[index++].innerHTM = dataJSON.ok;
					row.cell[index++].innerHTM = dataJSON.failUp;
					row.cell[index++].innerHTM = dataJSON.failDown;		
					
					console.log("Fila creada " + dataJSON.service);
					
				});
			}
		}
	}

	function addRow(table, dataJSON) {

		console.log("Creamos fila para: " + dataJSON.service);
		
		var rowCount = table.rows.length;
		var row = table.insertRow(rowCount);
		row.id = "row" + dataJSON.service;

		return row;
	
		}
	
</script>
<body>
	<div class="navbar">
		<div class="navbar-inner">
			<a class="brand" href="#">Cuadro de Mandos para la evaluación de
				los tiempos de ejecución.</a>
		</div>
	</div>

	<input type="button" value="Text" onclick="callService()">

	<script src="http://d3js.org/d3.v3.js"></script>
	<script>
		
	</script>
	<table class="reference" style="width: 60%" id="tableServices">
		<tr>
			<th>Servicio</th>
			<th>Tiempo medio</th>
			<th>Intervalo aceptable</th>
			<th>% aceptables</th>
			<th>% bajo el intervalo</th>
			<th>% por encima del intervalo</th>
		</tr>

		<tr id="row"></tr>

	</table>

</body>
